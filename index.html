<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎯 Bucket Dreams - 나의 버킷리스트</title>
    <meta name="description" content="개인 및 공용 기기에서 사용할 수 있는 버킷리스트 관리 앱. 목표를 설정하고 달성 과정을 기록하세요.">
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIuuCmOydmCDrsoTsgrHrpqzsirDtirgiLAogICJzaG9ydF9uYW1lIjogIuuyhOyCreDwJHRhvEhhdmvOr0dpTyIsCiAgImRlc2NyaXB0aW9uIjogIuydscDGDeyWReEhCKRZP2JCJOyGNeygz+ydBQUZQIOm2yC8JCl0dLXs2AyY6xKrQ1BBTiLAogICJzdGFydF91cmwiOiAiLyIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiI2ZmZmZmZiIsCiAgInRoZW1lX2NvbG9yIjogIiM0ZmFjZmUiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI2YVdSMGFEMGlNakEwSWlCb1pXbG5hSFE5SWpJd05DSWdkbWxsZDBKdmVEMGlNQ0F3SURJd05DQXlNRFFpSUdacGJHdzlJaU5tWm1ZaUlHOXRibTQ5SW1SQWMzbHRZbTlzYVc1bFFHRjRVblpwWVU1dVpOUThheXdRMFhBVnZaUWhxZERrY2pqZ1JNdjhLV0ZYbGlSbkNpbzNLU1YzZm5ReDJZc3l4cGhXQ1NDQWJIUVhsbUFCNGcydWF1VHJOejdIVjFGcXZLOVhGWWIiCiAgICAgICJzaXplcyI6ICIxOTJ4MTkyIiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIKICAgIH0KICBdCn0=">
    <meta name="theme-color" content="#4facfe">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- 프로필 선택 화면 -->
    <section class="profile-selector" id="profileSelector" role="main" aria-label="사용자 프로필 선택">
        <header>
            <h1>🎯 버킷리스트</h1>
            <p>사용자를 선택하거나 새로 시작하세요</p>
        </header>
        
        <div class="profile-options" id="profileOptions" role="list" aria-label="사용자 프로필 목록">
            <!-- 기존 프로필들과 새 사용자 옵션이 여기에 동적 생성됩니다 -->
        </div>
    </section>

    <!-- 메인 앱 화면 -->
    <main class="container main-app" id="mainApp">
        <header class="header">
            <div class="header-content">
                <h1 id="headerTitle">🎯 나의 버킷리스트</h1>
                <p>인생에서 꼭 해보고 싶은 것들을 기록하고 달성해보세요</p>
            </div>
            <nav class="header-controls" aria-label="헤더 메뉴">
                <button class="header-btn" id="settingsBtn" aria-label="이미지 설정 열기">⚙️ 이미지 설정</button>
                <button class="header-btn" id="userSwitchBtn" aria-label="다른 사용자로 전환">👥 사용자 전환</button>
                <button class="header-btn" id="finishBtn" aria-label="현재 세션 종료">🚪 사용 완료</button>
            </nav>
        </header>

        <nav class="nav-tabs" role="tablist" aria-label="메인 탭 메뉴">
            <button class="nav-tab active" data-tab="goals" role="tab" aria-selected="true" aria-controls="goals-tab" tabindex="0" id="goals-tab-button">📝 목표 관리</button>
            <button class="nav-tab" data-tab="gallery" role="tab" aria-selected="false" aria-controls="gallery-tab" tabindex="-1" id="gallery-tab-button">🏆 완료 갤러리</button>
            <button class="nav-tab" data-tab="data" role="tab" aria-selected="false" aria-controls="data-tab" tabindex="-1" id="data-tab-button">💾 데이터 관리</button>
        </nav>

        <!-- 목표 관리 탭 -->
        <section class="tab-content active" id="goals-tab" role="tabpanel" aria-labelledby="goals-tab-button">
            <div class="controls">
                <form class="add-form" aria-label="새 목표 추가 폼" role="form">
                    <div class="form-group">
                        <label for="goalInput">목표</label>
                        <input type="text" id="goalInput" placeholder="예: 오로라 보기, 마라톤 완주하기" aria-describedby="goal-help" aria-required="true">
                        <div id="goal-help" class="sr-only">달성하고 싶은 목표를 입력하세요. 엔터키로도 추가할 수 있습니다.</div>
                    </div>
                    <div class="form-group">
                        <label for="categorySelect">카테고리</label>
                        <select id="categorySelect" aria-label="목표 카테고리 선택" aria-required="true">
                            <option value="travel">🌍 여행</option>
                            <option value="hobby">🎨 취미</option>
                            <option value="career">💼 커리어</option>
                            <option value="relationship">👥 인간관계</option>
                            <option value="health">💪 건강</option>
                            <option value="other">✨ 기타</option>
                        </select>
                    </div>
                    <button type="button" class="btn btn-primary" id="addGoalBtn" aria-label="새 목표 추가하기">추가</button>
                </form>

                <nav class="filters" role="group" aria-label="카테고리 필터">
                    <button class="filter-btn active" data-category="all" role="button" tabindex="0" aria-pressed="true">전체</button>
                    <button class="filter-btn" data-category="travel" role="button" tabindex="0" aria-pressed="false">🌍 여행</button>
                    <button class="filter-btn" data-category="hobby" role="button" tabindex="0" aria-pressed="false">🎨 취미</button>
                    <button class="filter-btn" data-category="career" role="button" tabindex="0" aria-pressed="false">💼 커리어</button>
                    <button class="filter-btn" data-category="relationship" role="button" tabindex="0" aria-pressed="false">👥 인간관계</button>
                    <button class="filter-btn" data-category="health" role="button" tabindex="0" aria-pressed="false">💪 건강</button>
                    <button class="filter-btn" data-category="other" role="button" tabindex="0" aria-pressed="false">✨ 기타</button>
                </nav>
            </div>

            <div class="content">
                <section class="stats" aria-label="목표 통계">
                    <div class="stat-card" role="img" aria-label="총 목표 개수">
                        <div class="stat-number" id="totalCount" aria-live="polite">0</div>
                        <div class="stat-label">총 목표</div>
                    </div>
                    <div class="stat-card" role="img" aria-label="완료된 목표 개수">
                        <div class="stat-number" id="completedCount" aria-live="polite">0</div>
                        <div class="stat-label">완료</div>
                    </div>
                    <div class="stat-card" role="img" aria-label="진행률 퍼센트">
                        <div class="stat-number" id="progressPercent" aria-live="polite">0%</div>
                        <div class="stat-label">진행률</div>
                    </div>
                </section>

                <section class="bucket-list" id="bucketList" aria-label="버킷리스트 목록" role="region">
                    <div class="empty-state">
                        <h3>아직 목표가 없습니다</h3>
                        <p>첫 번째 버킷리스트를 추가해보세요!</p>
                    </div>
                </section>
            </div>

            <div class="download-section">
                <button class="btn btn-secondary" id="downloadPdfBtn" aria-label="전체 리스트를 PDF로 다운로드">📄 전체 리스트 PDF 다운로드</button>
            </div>
        </section>

        <!-- 완료 갤러리 탭 -->
        <section class="tab-content" id="gallery-tab" role="tabpanel" aria-labelledby="gallery-tab-button">
            <div class="content">
                <div class="sort-controls">
                    <label for="gallerySort" class="sort-label">정렬:</label>
                    <select class="sort-select" id="gallerySort" aria-label="갤러리 정렬 방식 선택">
                        <option value="date-desc">최신 완료순</option>
                        <option value="date-asc">오래된 완료순</option>
                        <option value="category">카테고리별</option>
                    </select>
                </div>
                
                <section class="gallery-grid" id="galleryGrid" aria-label="완료된 목표 갤러리" role="region">
                    <div class="empty-state">
                        <h3>완료된 목표가 없습니다</h3>
                        <p>첫 번째 목표를 달성해보세요!</p>
                    </div>
                </section>
            </div>
        </section>

        <!-- 데이터 관리 탭 -->
        <section class="tab-content" id="data-tab" role="tabpanel" aria-labelledby="data-tab-button">
            <div class="content">
                <section class="profile-management">
                    <h3 style="margin-bottom: 15px;">👤 프로필 관리</h3>
                    <div class="data-management" role="group" aria-label="데이터 관리 기능">
                        <button class="btn btn-success" id="exportBtn" aria-label="내 데이터를 JSON 파일로 내보내기">📤 내 데이터 내보내기</button>
                        <button class="btn btn-info" id="importBtn" aria-label="JSON 파일에서 데이터 가져오기">📥 데이터 가져오기</button>
                        <input type="file" id="importFile" accept=".json" style="display: none;" aria-label="데이터 파일 선택">
                        <button class="btn btn-warning" id="profileManagerBtn" aria-label="프로필 관리자 열기">⚙️ 프로필 관리</button>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <h4 style="margin-bottom: 10px; color: #dc3545;">🗑️ 데이터 삭제</h4>
                        <div class="data-management" role="group" aria-label="데이터 삭제 기능">
                            <button class="btn btn-warning" id="clearDataBtn" aria-label="현재 프로필의 모든 목표 삭제">🔄 내 목표 모두 삭제</button>
                            <button class="btn btn-danger" id="deleteProfileBtn" aria-label="현재 프로필 완전 삭제">❌ 내 프로필 삭제</button>
                            <button class="btn btn-danger btn-danger-extreme" id="clearAllBtn" aria-label="모든 프로필 완전 삭제">💥 모든 프로필 삭제</button>
                        </div>
                        <div style="font-size: 0.8rem; color: #dc3545; margin-top: 8px; text-align: center;" role="alert">
                            ⚠️ 삭제된 데이터는 복구할 수 없습니다. 신중히 선택하세요.
                        </div>
                    </div>
                    
                    <section class="profile-list" id="profileList" aria-label="저장된 프로필 목록">
                        <!-- 프로필 목록이 여기에 동적 생성됩니다 -->
                    </section>
                </section>

                <section style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-top: 20px;">
                    <h3 style="margin-bottom: 15px;">💡 공용 기기 사용 팁</h3>
                    <ul style="color: #6c757d; line-height: 1.6;">
                        <li><strong>개인 데이터 보호:</strong> 각자의 프로필로 독립적인 데이터 관리</li>
                        <li><strong>파일 백업:</strong> 개인 JSON 파일로 안전하게 데이터 보관</li>
                        <li><strong>자동 로그아웃:</strong> 30분 비활성 시 자동으로 사용자 선택 화면으로 이동</li>
                        <li><strong>사용 완료:</strong> 다 사용한 후에는 "사용 완료" 버튼으로 안전하게 종료</li>
                        <li><strong>게스트 모드:</strong> 임시 사용자는 데이터가 저장되지 않음</li>
                        <li><strong>데이터 정리:</strong> 필요 시 목표만 삭제하거나 프로필 전체 삭제 가능</li>
                    </ul>
                </section>

                <aside style="background: #fff3cd; padding: 15px; border-radius: 10px; margin-top: 15px; border-left: 4px solid #ffc107;" role="alert">
                    <h4 style="margin-bottom: 10px; color: #856404;">⚠️ 데이터 삭제 안내</h4>
                    <ul style="color: #856404; line-height: 1.5; font-size: 0.9rem;">
                        <li><strong>내 목표 모두 삭제:</strong> 현재 프로필의 버킷리스트만 삭제 (프로필은 유지)</li>
                        <li><strong>내 프로필 삭제:</strong> 현재 프로필과 모든 데이터 완전 삭제</li>
                        <li><strong>모든 프로필 삭제:</strong> 앱의 모든 사용자 데이터 완전 초기화</li>
                        <li><strong>⚠️ 주의:</strong> 삭제된 데이터는 복구할 수 없으니 백업 후 진행하세요</li>
                    </ul>
                </aside>

                <section style="margin-top: 30px;">
                    <h3 style="margin-bottom: 15px;">📊 현재 프로필 데이터</h3>
                    <div class="stats" aria-label="프로필 데이터 통계">
                        <div class="stat-card" role="img" aria-label="총 목표 수">
                            <div class="stat-number" id="dataStatsTotal" aria-live="polite">0</div>
                            <div class="stat-label">총 목표 수</div>
                        </div>
                        <div class="stat-card" role="img" aria-label="완료된 목표">
                            <div class="stat-number" id="dataStatsCompleted" aria-live="polite">0</div>
                            <div class="stat-label">완료된 목표</div>
                        </div>
                        <div class="stat-card" role="img" aria-label="데이터 크기">
                            <div class="stat-number" id="dataStatsSize" aria-live="polite">0KB</div>
                            <div class="stat-label">데이터 크기</div>
                        </div>
                    </div>
                </section>
            </div>
        </section>
    </main>

    <!-- 자동 로그아웃 알림 -->
    <div class="auto-logout-notice" id="autoLogoutNotice" role="alert" aria-live="assertive">
        <span id="autoLogoutText">5분 후 자동 로그아웃됩니다</span>
        <button id="extendBtn" aria-label="세션 연장하기">연장</button>
    </div>

    <!-- 완료/편집 모달 (날짜 입력 기능 포함) -->
    <div class="modal" id="completionModal" role="dialog" aria-labelledby="modalTitle" aria-describedby="modalSubtitle" aria-hidden="true" aria-modal="true">
        <div class="modal-content">
            <header class="modal-header">
                <h2 class="modal-title" id="modalTitle">🎉 목표 달성!</h2>
                <p class="modal-subtitle" id="modalSubtitle">이 순간의 느낌을 기록해보세요</p>
            </header>
            <form class="modal-form" role="form">
                <label for="completionDate">달성 날짜</label>
                <input type="date" id="completionDate" aria-required="true">
                <label for="completionNote">달성 후기</label>
                <textarea id="completionNote" placeholder="어떤 기분이었나요? 어떤 경험이었는지 간단히 적어보세요." aria-describedby="note-help"></textarea>
                <div id="note-help" class="sr-only">선택사항입니다. 달성 후 느낌이나 경험을 자유롭게 작성하세요.</div>
            </form>
            <div class="modal-buttons">
                <button class="btn-modal btn-cancel" id="cancelModalBtn" aria-label="모달 취소">취소</button>
                <button class="btn-modal btn-confirm" id="saveModalBtn" aria-label="달성 정보 저장">저장</button>
            </div>
        </div>
    </div>

    <!-- 새 사용자 모달 -->
    <div class="modal" id="newUserModal" role="dialog" aria-labelledby="newUserTitle" aria-hidden="true" aria-modal="true">
        <div class="modal-content">
            <header class="modal-header">
                <h2 class="modal-title" id="newUserTitle">👋 새 사용자</h2>
                <p class="modal-subtitle">버킷리스트에 표시할 이름을 입력해주세요</p>
            </header>
            <form class="modal-form" role="form">
                <label for="newUserNameInput">사용자 이름</label>
                <input type="text" id="newUserNameInput" placeholder="예: 홍길동" aria-required="true" aria-describedby="name-help">
                <div id="name-help" class="sr-only">다른 사용자와 구분할 수 있는 이름을 입력하세요. 엔터키로도 생성할 수 있습니다.</div>
            </form>
            <div class="modal-buttons">
                <button class="btn-modal btn-cancel" id="cancelNewUserBtn" aria-label="사용자 생성 취소">취소</button>
                <button class="btn-modal btn-confirm" id="createUserBtn" aria-label="새 사용자 생성">생성</button>
            </div>
        </div>
    </div>

    <!-- 프로필 관리 모달 -->
    <div class="modal" id="profileManagerModal" role="dialog" aria-labelledby="profileManagerTitle" aria-hidden="true" aria-modal="true">
        <div class="modal-content" style="max-width: 500px;">
            <header class="modal-header">
                <h2 class="modal-title" id="profileManagerTitle">⚙️ 프로필 관리</h2>
                <p class="modal-subtitle">저장된 사용자 프로필을 관리합니다</p>
            </header>
            <div id="profileManagerContent" aria-label="프로필 관리 내용">
                <!-- 프로필 관리 내용이 여기에 동적 생성됩니다 -->
            </div>
            <div class="modal-buttons">
                <button class="btn-modal btn-cancel" id="closeProfileManagerBtn" aria-label="프로필 관리자 닫기">닫기</button>
            </div>
        </div>
    </div>

    <!-- PWA 설치 버튼 -->
    <button class="install-btn" id="installBtn" aria-label="앱을 기기에 설치하기">📱 앱 설치</button>

    <!-- 개별 카드 다운로드용 숨겨진 영역 -->
    <div id="hiddenCardArea" style="position: absolute; left: -9999px; top: -9999px;" aria-hidden="true"></div>
    
    <!-- 스크린 리더용 숨겨진 텍스트 -->
    <div class="sr-only">
        이 웹사이트는 스크린 리더와 키보드 네비게이션을 지원합니다. 
        탭 키로 요소 간 이동, 엔터 또는 스페이스 키로 버튼 실행, 
        방향키로 목록 네비게이션이 가능합니다.
    </div>
    
    <!-- 제작자 정보 -->
    <footer style="
        position: fixed;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 0.75rem;
        color: #999;
        text-align: center;
        z-index: 50;
        background: rgba(255, 255, 255, 0.9);
        padding: 5px 15px;
        border-radius: 20px;
        backdrop-filter: blur(10px);
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    ">
        <span>Made with ❤️ by 룰루랄라 한기쌤</span>
        <a href="https://www.facebook.com/playrurulala" target="_blank" rel="noopener noreferrer" style="
            color: #1877f2;
            text-decoration: none;
            margin-left: 8px;
            font-weight: 600;
            transition: all 0.3s;
        " id="fbLink" aria-label="룰루랄라 한기쌤 페이스북 페이지 (새 창에서 열기)">
            <span style="font-size: 0.9rem;" aria-hidden="true">f</span> Facebook
        </a>
    </footer>

    <script src="script.js"></script>
</body>
</html>